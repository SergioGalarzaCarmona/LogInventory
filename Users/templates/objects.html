{%load static%}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{%static '/styles/objectStyles.css'%}">
    <title>Objetos</title>
    <link rel="icon" href="{%static '/images/MiniLogoType.webp'%}" type="image/webp">
    <meta name="description" content="Objetos LOG INVENTORY">
    <meta name="author" content="LOG INVENTORY">
    <meta name="robots" content="noindex, nofollow">
</head>
<body>
    <header class="header">
        <ul class="header__tools">
            <li class="work-space">
                <a href="{% url 'main' %}" class="work-space__link" id="link">
                    <img src="{%static '/images/casa.webp'%}" alt="work-space" class="work-space-img">
                    <div>Área de trabajo</div>
                </a>
            </li>
            <li class="header__tools-record">
                <a href="{% url 'record' %}" class="header__tools-record_link">
                    <img src="{%static '/images/transaction-history_9710379.webp'%}" alt="Record image">
                </a>
            </li>
            <li class="log_out">
                <a href="{%url 'log_out'%}" class="log_out-link">
                    <div>Cerrar sesión</div>
                    <img class="log_out__image" src="../static/images/log_out.webp" alt="Cerrar sesión">
                </a>
            </li>
        </ul>
    </header>
    <main>
        <div class="object__img-container">
            <img src="media/{{object.image}}" alt="object-image" class="object__img">
        </div>
        <div class="object__description">
            <h1>{{object.name}}</h1>
            <form class="object__description-form" method="POST">
                {{change_invalid}}
                {{message}}
                {% csrf_token %}
                {{form}}
                <input type="submit" value="Actualizar">
            </form>
        </div>
        {% for instance in record_object %}
        <div class="object__record">
            <h1>Objeto: {{instance.object_id.name}}</h1>
            <div class="transaction"> 
                {% if instance.object_id.show_object == 0 %}
                <p class="transaction-type">Tipo de transacción: Eliminacion de objeto</p>
                {% elif instance.type_transaction_id == 1 %}
                <p class="transaction-type">Tipo de transacción: Adición</p>
                {% elif instance.type_transaction_id == 2 %}
                <p class="transaction-type">Tipo de transacción: Sustracción</p>
                {% elif instance.type_transaction_id == 4 %}
                <p class="transaction-type">Tipo de transacción: Remodelación de objeto</p>
                {% endif %}
                <p class="stock-before">Stock antes: {{instance.stock_before}}</p>
                <p class="stock-after">Stock después: {{instance.stock_after}}</p>
                <p class=".time">Hora: {{instance.date}}</p>
                <form method="POST">
                    {% csrf_token %}
                    <input class="hidden" type="number" hidden name="transaction" value="{{instance.transaction_id}}">
                    <input class="hidden" type="number" hidden name=object value="{{instance.object_id.object_id}}">
                    {% if instance.type_transaction_id == 4 and instance.stock_before == instance.stock_after %}
                    <input class="go-back__button" type="submit" value="Retroceder cambios" disabled>
                    {% else %}
                    <input class="go-back__button" type="submit" value="Retroceder cambios">
                    {% endif %}
                </form> 
            </div>
        </div>
        {% endfor %}
        <img src="media/{{object.image}}" alt="object_image" class="object_image">
        <h1>{{object.name}}</h1>
        <form method="POST">
            {{change_invalid}}
            {{message}}
            {% csrf_token %}
            <div>
                <label for="id_name">Nombre:</label>
                <input type="text" name="name" value="{{object.name}}" maxlength="50" required="" id="id_name">
            </div>
            <div>
                <label for="id_stock">Stock:</label>
                <input type="number" name="stock" value="{{object.stock}}" required="" id="id_stock">  
            </div>
            <div>
                <label for="id_description">Descripción:</label>
                <textarea name="description" cols="40" rows="10" maxlength="500" required="" id="id_description">{{object.description}}</textarea>
            </div>
            <div>
                <input type="checkbox" name="image-clear" id="image-clear_id">
                <label for="image-clear_id">Borrar Imagen</label>
                <input type="file" name="image" accept="image/*" id="id_image">
            </div>
            <input type="submit" value="Actualizar">
        </form>
        {% for instance in record_object %}
        <div>
            {% if instance.object_id.show_object == 0 %}
            <p class="transaction-type">Tipo de transaction: Eliminacion de objeto</p>
            {% elif instance.type_transaction_id == 1 %}
            <p class="transaction-type">Tipo de transaction: Adición</p>
            {% elif instance.type_transaction_id == 2 %}
            <p class="transaction-type">Tipo de transaction: Sustraccion</p>
            {% elif instance.type_transaction_id == 4 %}
            <p class="transaction-type">Tipo de transaction: Remodelación de objeto</p>
            {% elif instance.type_transaction_id == 5 %}
            <p class="transaction-type">Tipo de transaction: Retroceso</p>
            {% endif %}
            <p>Stock antes: {{instance.stock_before}}</p>
            <p>Stock después: {{instance.stock_after}}</p>
            <p>Hora: {{instance.date}}</p>
            <form class="go-back" method="POST">
                {% csrf_token %}
                <input type="number" hidden name="transaction" value="{{instance.transaction_id}}">
                <input type="number" hidden name=object value="{{instance.object_id.object_id}}">
                {% if instance.type_transaction_id == 4 and instance.stock_before == instance.stock_after %}
                <input class="go-back__button" type="submit" value="Retroceder cambios" disabled>
                {% elif instance.type_transaction_id == 5 or instance.type_transaction_id == 3%}
                <input class="go-back__button" type="submit" value="Retroceder cambios" disabled>
                {% else %}
                <input class="go-back__button" type="submit" value="Retroceder cambios">
                {% endif %}
            </form> 
        </div>
        {% endfor %}
        </div>
    </main>
    <script src="../../static/scripts/recordScript.js"></script> 
</body>
</html>